<html>
<body>
<a href="https://github.com/olamkulam/youtube-playlist/">Github Repository</a>
<br>
<div id="video-youtube" style="display: block; margin: auto;"></div>
<br>
<button id="update-button" style="display: block; margin: auto; padding: 20px 40px; font-size: 24px; font-weight: bold; background-color: #FF0000; color: white; border: none; cursor: pointer; border-radius: 8px; transition: background-color 0.3s ease;" onmouseover="this.style.backgroundColor='#CC0000'" onmouseout="this.style.backgroundColor='#FF0000'"">Play the playlist</button>
<br>
<div style="display: flex; justify-content: center; align-items: center;">
    <div id="previous-button" style="font-size: 48px; cursor: pointer; margin: 0 10px;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'" onmousedown="this.style.transform='scale(0.95)'" onmouseup="this.style.transform='scale(1)'">⏮️</div>
    <div id="next-button" style="font-size: 48px; cursor: pointer; margin: 0 10px;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'" onmousedown="this.style.transform='scale(0.95)'" onmouseup="this.style.transform='scale(1)'">⏭️</div>
</div>
<p style="text-align: center; margin-top: 20px; font-size: 24px; color: #666;">For a complete experience please avoid skipping</p>

<script id="youtube-tracking-script">

    var playList = [
        {"videoId":"MMICmo6Hj0k","start":3.7,"end":19.5}, // הללויה

        {"videoId":"0dXbF-hjiNE","start":4,"end":16}, // פוקימון
        {"videoId":"h5EfvrT7Lmo","start":73,"end":81}, // מכיר אותו
        {"videoId":"ZpebRTrNCeI","start":16,"end":30}, // והילד הזה הוא אני
        {"videoId":"iRMcBjUTgkw","start":74.3,"end":80.2}, // ג'ינג'ית
        {"videoId":"TsPTkUx4mgo","start":24,"end":35}, // תמיד יחכו לך
        {"videoId":"d3gvRBC5xUM","start":140,"end":142.2}, // אורח בעולם
        
        {"videoId":"HNCQ9aQdAJA","start":82.5,"end":99}, // מחוזקים לעולם
        {"videoId":"1KXvF6fZJ24","start":43,"end":60}, // יצאנו לרקוד
        {"videoId":"opJgHeNo5UA","start":47,"end":67}, // את יפה
        {"videoId":"PAHHFO3hB2o","start":42,"end":56}, // הכי יפה בעולם
        {"videoId":"ZvJOotcQhuA","start":192,"end":202.8}, // לשם
        {"videoId":"TX4rGTFSYZs","start":87,"end":96}, // פנס בודד
        {"videoId":"mZt6Y72VmqQ","start":10,"end":40}, // תגידי לה
        {"videoId":"pX1eFNrMSoQ","start":11,"end":24.3}, // כמו כולם
        {"videoId":"dauW62xmwZQ","start":137.5,"end":141.8}, // הכל עוד לפניי
        {"videoId":"gP6PS-poyMg","start":33,"end":47}, // אני ואתה
        
        {"videoId":"tFEUH-tHeXE","start":114,"end":122.6}, // אין כמוך בעולם
        {"videoId":"aqZMHUEE3uA","start":32,"end":46}, // ברבאבא
        {"videoId":"pNmI5WDweyU","start":23,"end":31}, // לאבא שלי יש סולם
        {"videoId":"WhxcSxDgtHI","start":40,"end":53}, // אבא
        {"videoId":"-CZqRKYznrM","start":58,"end":65.4}, // מי שמאמין
        {"videoId":"EQn6vLXeGGw","start":22,"end":37.5}, // אבא נשמה
        {"videoId":"2VxXCa8YmPY","start":22,"end":30}, // כך בראו את העולם
        {"videoId":"1KbMQk7beQg","start":75.5,"end":97}, // השר משה מונטיפיורי
        {"videoId":"Ymj-JKDJhkY","start":34,"end":56}, // עץ אלון
        {"videoId":"JqnjeXWGBxY","start":80.5,"end":95.3}, // הרעות
        {"videoId":"pVWIiALUvN0","start":32.5,"end":46.7}, // הם ישנם
        {"videoId":"l7JS58MvJQU","start":214.3,"end":221.2}, // כתונת הפסים
        {"videoId":"UWV66heLMbA","start":198.8,"end":221}, // כל החלומות
        
        {"videoId":"RrMQzGZDyqE","start":12.3,"end":18}, // פינוקיו
        {"videoId":"g-9piggPT6E","start":256.8,"end":264.7}, // סלאם
        {"videoId":"ma8toliooNQ","start":41,"end":45.5}, // שירת הסטיקר
        {"videoId":"7Whi2fmeQZs","start":133,"end":145}, // עושה קסמים ורוקנרול
        {"videoId":"END5VRXWqkU","start":51.6,"end":65}, // קטן זה הכי כיף בעולם
        {"videoId":"443t_gJ_DNg","start":67.8,"end":75.8}, // צפצפי
        
        {"videoId":"F_ZbGHBG2M8","start":38.4,"end":47}, // איזה עולם        
        {"videoId":"XwPEtD0_mx4","start":122,"end":125}, // יוניקורן
        {"videoId":"pTNzcyHDeiw","start":33,"end":38.5}, // צהוב כחול
        {"videoId":"ks6cDQ0yQoY","start":41,"end":47.7}, // רחוק מכולם
        {"videoId":"h3P7ko3VUWY","start":215.3,"end":225.5}, // להציל אותך

        {"videoId":"MIC7SaFC63Y","start":37,"end":50}, // על גג העולם
        {"videoId":"hD-Gacu1ZRY","start":190,"end":202.5}, // אני רוצה גם
        {"videoId":"99tIGPlFk2o","start":101,"end":109}, // אני רוצה להיות
        {"videoId":"SoQGFbnM4_A","start":110.6,"end":133.5}, // רמקולים       
        {"videoId":"-swxKEEb3p8","start":79.7,"end":84.5}, // שלום על העולם        
        {"videoId":"G4q-S_zdFYk","start":87.5,"end":99.4}, // עולם אחר        
        {"videoId":"8ROhY-rooHk","start":58.5,"end":62.4}, // חברים לי בעולם
        {"videoId":"assCFLm01Uo","start":358.3,"end":367.75}, // עם אחד שיר אחד
        {"videoId":"LhEVbDprJ8s","start":119.1,"end":123.5}, // שירו של שפשף
        {"videoId":"iCitB5bkB3E","start":151,"end":163.2}, // ואז את תראי
        {"videoId":"Md21OZKntbg","start":153.6,"end":158.7}, // ראיתי עולם

        {"videoId":"_GDaWZqqI_A","start":21.3,"end":28.6}, // כולם חכמים כולם
        {"videoId":"kcjOWCp7-Ro","start":127.8,"end":149.4}, // כמעט
    ];

    var totalSeconds = playList.reduce((accumulator, currentSong) => accumulator + currentSong.end - currentSong.start, 0);
    var minutes = Math.floor(totalSeconds / 60);
    console.log(`Playlist consists of ${playList.length} songs, with total duration of ${minutes}:${Math.round(totalSeconds % 60)}`);

    var currentId = 0;

    var updateButton = document.getElementById('update-button');
    updateButton.addEventListener('click', function(event) {
        currentId = 0;
        player.loadVideoById({
            'videoId': playList[currentId].videoId,
            'startSeconds': playList[currentId].start,
            'endSeconds': playList[currentId].end
        });
    });

    var tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";

    var firstScriptTag = document.getElementById("youtube-tracking-script");
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    var player;

    function onYouTubeIframeAPIReady() {
        player = new YT.Player('video-youtube', {
            height: '500px',
            width: '1000px',
            videoId: playList[0].videoId,
            playerVars: {
                'autoplay': 0,
                'start': playList[0].start,
                'end': playList[0].end
            },
            events: {
                'onStateChange': videoPlay
            }
        });
    }

    var debouncing = false;

    function videoPlay(event) {
        if (event.data == YT.PlayerState.PLAYING) {
            debouncing = false;
            console.log("YouTube Video is PLAYING!!");
        }
        if (event.data == YT.PlayerState.PAUSED) {
            console.log("YouTube Video is PAUSED!!");
        }

        // after loading next video, before startin the next one, one extra end event will be passed,
        // so need this debouncing logic
        if ( debouncing )
            return;
        if ( event.data == YT.PlayerState.ENDED ) {
            debouncing = true;
            console.log("YouTube Video is ENDING!!");
            currentId++;
            if ( playList[currentId] ) {
                player.loadVideoById({
                    'videoId': playList[currentId].videoId,
                    'startSeconds': playList[currentId].start,
                    'endSeconds': playList[currentId].end
                });
            }
        }
    }


    var nextButton = document.getElementById('next-button');
    nextButton.addEventListener('click', goToNext);

    var previousButton = document.getElementById('previous-button');
    previousButton.addEventListener('click', goToPrevious);

    function goToNext(){
        currentId++;
        if ( playList[currentId] ) {
            player.loadVideoById({
                'videoId': playList[currentId].videoId,
                'startSeconds': playList[currentId].start,
                'endSeconds': playList[currentId].end
            });
        }
    }

    function goToPrevious(){
        currentId--;
        if ( playList[currentId] ) {
            player.loadVideoById({
                'videoId': playList[currentId].videoId,
                'startSeconds': playList[currentId].start,
                'endSeconds': playList[currentId].end
            });
        }
    }
</script>
</body>
</html>
